server {
    listen 80;
    server_name www.mazey.net;
    root /web/mazey/www/;
    index index.html index.php;
    # post
    if ($request_uri ~* ^/baby/blog/archives/\d*.*$) {
        rewrite ^/baby/blog/archives/(\d*)$ http://blog.mazey.net/$1.html permanent;
    }
    # home
    if ($request_uri ~* ^/baby/blog[/]?$) {
        rewrite ^/baby/blog[/]?$ http://blog.mazey.net/ permanent;
    }
    # category
    if ($request_uri ~* ^/baby/blog/archives/[a-zA-Z]*/.*$) {
        rewrite ^/baby/blog/archives/([a-zA-Z]*/.*)$ http://blog.mazey.net/$1 permanent;
    }
    # pagination
    if ($request_uri ~* ^/baby/blog/page/\d*.*$) {
        rewrite ^/baby/blog/page/(\d*)$ http://blog.mazey.net/page/$1 permanent;
    }
    # baby => app
    if ($request_uri ~* ^/baby/.*$) {
        rewrite ^/baby/(.*)$ http://www.mazey.net/app/$1 permanent;
    }
    location ~ .*\.(php|php5)?$ {
        fastcgi_pass 127.0.0.1:9000;
        fastcgi_index index.php;
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
        include fastcgi_params;
    }
    location ~ .*\.(gif|jpg|jpeg|png|bmp|swf)$ {
        expires 30d;
    }
    location ~ .*\.(js|css)?$ {
        expires 1h;
    }
}
